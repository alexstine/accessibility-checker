class AccessibilityCheckerDisableHTML{constructor(){this.disableStylesButton=document.querySelector("#edac-highlight-disable-styles"),this.init()}init(){this.disableStylesButton.addEventListener("click",(()=>this.disabledStyles()))}disabledStyles(){var t=Array.from(document.head.querySelectorAll('style[type="text/css"], style, link[rel="stylesheet"]'));document.querySelectorAll('*[style]:not([class^="edac"])').forEach((function(t){t.removeAttribute("style")})),t=t.filter((function(t){return console.log(t.id),"edac-css"!==t.id&&"dashicons-css"!==t.id})),document.head.dataset.css=t,t.forEach((function(t){t.remove()}))}}class AccessibilityCheckerHighlight{constructor(){this.nextButton=document.querySelector("#edac-highlight-next"),this.previousButton=document.querySelector("#edac-highlight-previous"),this.panelToggle=document.querySelector("#edac-highlight-panel-toggle"),this.currentButtonIndex=0,this.init(),this.highlightButtonFocus(),this.highlightButtonFocusOut()}init(){this.nextButton.addEventListener("click",(()=>this.highlightFocusNext())),this.previousButton.addEventListener("click",(()=>this.highlightFocusPrevious())),this.panelToggle.addEventListener("click",(()=>this.panelOpen()))}findElement(t){const e=t.object,i=(new DOMParser).parseFromString(e,"text/html");console.log(i);const n=i.body.firstElementChild;if(!n)return null;const s=document.body.querySelectorAll("*");for(const e of s)if(e.outerHTML===n.outerHTML)return this.wrapElement(e,t),this.addTooltip(e,t),e;return null}highlightAjax(){const t=new XMLHttpRequest,e=edac_script_vars.ajaxurl+"?action=edac_frontend_highlight_ajax&post_id="+edac_script_vars.postID+"&nonce="+edac_script_vars.nonce;t.open("GET",e),t.onload=function(){if(200===t.status){const e=JSON.parse(t.responseText);if(!0===e.success){let t=JSON.parse(e.data);console.log(t),t.forEach(function(t,e){const i=this.findElement(t);console.log(i)}.bind(this))}else console.log(e)}else console.log("Request failed.  Returned status of "+t.status)}.bind(this),t.send()}wrapElement(t,e){const i=t.parentNode,n=document.createElement("div");n.className=`edac-highlight edac-highlight-${e.rule_type}`,i.insertBefore(n,t),n.appendChild(t)}addTooltip(t,e){const i=`\n\t\t\t<button class="edac-highlight-btn edac-highlight-btn-${e.ruletype}"\n\t\t\t\t\taria-label="${e.rule_title}"\n\t\t\t\t\taria-expanded="false"\n\t\t\t\t\tdata-rule-id="${e.slug}"\n\t\t\t\t\taria-controls="edac-highlight-tooltip-${e.id}"></button>\n\t\t`;t.insertAdjacentHTML("beforebegin",i)}highlightFocusNext(){const t=document.querySelectorAll(".edac-highlight-btn");this.currentButtonIndex=(this.currentButtonIndex+1)%t.length,t[this.currentButtonIndex].focus(),console.log("Visible: "+this.isElementVisible(t[this.currentButtonIndex])),console.log("Hidden: "+this.isElementHidden(t[this.currentButtonIndex]))}highlightFocusPrevious(){const t=document.querySelectorAll(".edac-highlight-btn");this.currentButtonIndex=(this.currentButtonIndex-1+t.length)%t.length,t[this.currentButtonIndex].focus()}isElementVisible(t){const e=t.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return e.top>=0&&e.left>=0&&e.bottom<=i&&e.right<=n}isElementHidden(t){return"none"===window.getComputedStyle(t).display}panelOpen(){document.querySelector("#edac-highlight-panel-controls").style.display="block",this.panelToggle.style.display="none",this.highlightAjax()}highlightButtonFocus(){document.addEventListener("focusin",(function(t){const e=t.target;if(e.classList.contains("edac-highlight-btn")){const t=e.closest(".edac-highlight");if(t){t.classList.add("active");const i=e.getAttribute("data-rule-id");console.log(i)}}}))}highlightButtonFocusOut(){document.addEventListener("focusout",(function(t){const e=t.target;if(e.classList.contains("edac-highlight-btn")){const t=e.closest(".edac-highlight");t&&t.classList.remove("active")}}))}}window.addEventListener("DOMContentLoaded",(()=>{new AccessibilityCheckerHighlight,new AccessibilityCheckerDisableHTML}));